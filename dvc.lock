schema: '2.0'
stages:
  preprocess_train:
    cmd: python src/preprocessing/prep_train.py
    deps:
    - path: data/raw/training/
      hash: md5
      md5: f88c3e0feb1c6c5daf1f84130480d403.dir
      size: 528522560
      nfiles: 9
    - path: src/preprocessing/prep_train.py
      hash: md5
      md5: ae60fe5604901ff1b7b4d32862d5ec17
      size: 5580
    outs:
    - path: data/processed/test/test_arrays.npz
      hash: md5
      md5: c2655f5ca7d52d3e54d297b79f4382a4
      size: 52660965
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
  train:
    cmd: python src/training/train.py
    deps:
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/training/train.py
      hash: md5
      md5: 1a0bdceac4682934f349a5fe16495aa0
      size: 5978
    outs:
    - path: models/artifacts/model.pkl
      hash: md5
      md5: cb0dcbe13e32f89b0454d3ac0970b69e
      size: 743765257
  monitor:
    cmd: python src/monitoring/monitor.py
    deps:
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: data/raw/inference
      hash: md5
      md5: 005d6e0a3612fb43a5fec4f8c52ff698.dir
      size: 121855060
      nfiles: 1
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/monitoring/monitor.py
      hash: md5
      md5: 0f00aa10ab8b669f31eb1f00d8062c3f
      size: 7299
    outs:
    - path: data/drift/drift_flag.txt
      hash: md5
      md5: cfcd208495d565ef66e7dff9f98764da
      size: 1
    - path: data/monitoring_reports/drift_report.html
      hash: md5
      md5: 3b2a19f6f19d3ad9c927bfa028ed7fd2
      size: 5518065
    - path: data/monitoring_reports/drift_report.json
      hash: md5
      md5: 2083e536b368055efe3a09e53c2b9253
      size: 85825
  infer_batch:
    cmd: python src/inference/infer_batch.py
    deps:
    - path: data/raw/inference/
      hash: md5
      md5: 005d6e0a3612fb43a5fec4f8c52ff698.dir
      size: 121855060
      nfiles: 1
    - path: models/artifacts/model.pkl
      hash: md5
      md5: cb0dcbe13e32f89b0454d3ac0970b69e
      size: 743765257
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/inference/infer_batch.py
      hash: md5
      md5: 9364048dbe2e80c9435891e5b75d525a
      size: 7125
    outs:
    - path: data/inference_logs/log.csv
      hash: md5
      md5: 9f333f6958aec98ea724f9cb79add6f7
      size: 600550013
    - path: data/inference_logs/predicciones_batch.csv
      hash: md5
      md5: 28e33f614b4bf00f0fe170743e08c9ec
      size: 128040517
  postprocess:
    cmd: python src/postprocessing/postprocessing.py
    deps:
    - path: data/inference_logs/predicciones_batch.csv
      hash: md5
      md5: 28e33f614b4bf00f0fe170743e08c9ec
      size: 128040517
    - path: src/postprocessing/postprocessing.py
      hash: md5
      md5: 0c16c2b0098c0b9d42b245c4069c1f61
      size: 4524
    outs:
    - path: data/postprocessed/business_value.csv
      hash: md5
      md5: 61d0d8d2935e70d0981f83a750b7c8ca
      size: 138920440
  retrain:
    cmd: python src/retraining/retrain.py
    deps:
    - path: data/drift/drift_flag.txt
      hash: md5
      md5: cfcd208495d565ef66e7dff9f98764da
      size: 1
    - path: src/retraining/retrain.py
      hash: md5
      md5: 62ba74a66054e2367327851c26b531d5
      size: 4186
