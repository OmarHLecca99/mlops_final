schema: '2.0'
stages:
  preprocess_train:
    cmd: python src/preprocessing/prep_train.py
    deps:
    - path: data/raw/training/
      hash: md5
      md5: 63c8f174a47f3e8c4e5af276c1c1fb9f.dir
      size: 528522352
      nfiles: 9
    - path: src/preprocessing/prep_train.py
      hash: md5
      md5: ae60fe5604901ff1b7b4d32862d5ec17
      size: 5580
    outs:
    - path: data/processed/test/test_arrays.npz
      hash: md5
      md5: c2655f5ca7d52d3e54d297b79f4382a4
      size: 52660965
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
  train:
    cmd: python src/training/train.py
    deps:
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/training/train.py
      hash: md5
      md5: 4be231d608dccfd9ce5d7890220b0488
      size: 5542
    outs:
    - path: models/artifacts/model.pkl
      hash: md5
      md5: 1c600445bb26200a433d889a84affbaf
      size: 1234642697
  monitor:
    cmd: python src/monitoring/monitor.py
    deps:
    - path: data/inference_logs/log.csv
      hash: md5
      md5: cab642c878543930c676e83662319c1c
      size: 600553314
    - path: data/processed/train/train_arrays.npz
      hash: md5
      md5: 92c449ca7082ff39e99ceffc40fb3743
      size: 210499387
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/monitoring/monitor.py
      hash: md5
      md5: ac214b32262116f50204839535c2f003
      size: 7316
    outs:
    - path: data/drift/drift_flag.txt
      hash: md5
      md5: cfcd208495d565ef66e7dff9f98764da
      size: 1
    - path: data/monitoring_reports/drift_report.html
      hash: md5
      md5: 120ff69cfc20b35fb2f75571a86e007f
      size: 5518065
    - path: data/monitoring_reports/drift_report.json
      hash: md5
      md5: 3d50944427c7bf01ccae49343baaa6da
      size: 85825
  infer_batch:
    cmd: python src/inference/infer_batch.py
    deps:
    - path: data/raw/inference/
      hash: md5
      md5: 005d6e0a3612fb43a5fec4f8c52ff698.dir
      size: 121855060
      nfiles: 1
    - path: models/artifacts/model.pkl
      hash: md5
      md5: 1c600445bb26200a433d889a84affbaf
      size: 1234642697
    - path: models/pipelines/preprocess.pkl
      hash: md5
      md5: 59a014c74cc618733b3a80459a523e0b
      size: 10349
    - path: src/inference/infer_batch.py
      hash: md5
      md5: 8a3f9e240cba519887ed6f24601bf93b
      size: 6009
    outs:
    - path: data/inference_logs/log.csv
      hash: md5
      md5: cab642c878543930c676e83662319c1c
      size: 600553314
    - path: data/inference_logs/predicciones_batch.csv
      hash: md5
      md5: a76b6bb62ecd896e274b366c88be2318
      size: 128043818
  postprocess:
    cmd: python src/postprocessing/postprocessing.py
    deps:
    - path: data/inference_logs/predicciones_batch.csv
      hash: md5
      md5: a76b6bb62ecd896e274b366c88be2318
      size: 128043818
    - path: src/postprocessing/postprocessing.py
      hash: md5
      md5: 198dc004c57f3d32b2b68c4707742a74
      size: 3562
    outs:
    - path: data/postprocessed/business_value.csv
      hash: md5
      md5: 20beb1f27bff151d0032b9b3d46e2c0d
      size: 138923122
  retrain:
    cmd: python src/retraining/retrain.py
    deps:
    - path: data/drift/drift_flag.txt
      hash: md5
      md5: cfcd208495d565ef66e7dff9f98764da
      size: 1
    - path: src/retraining/retrain.py
      hash: md5
      md5: b78772ed6c62f81a0635e73e1bbcf651
      size: 3453
